
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Rivet System Architecture</title>
    <style>
        body { margin: 0; padding: 0; overflow: hidden; background-color: #f0f0f0; }
        #graph { width: 100vw; height: 100vh; display: flex; justify-content: center; align-items: center; }
        svg { width: 100%; height: 100%; }
    </style>
</head>
<body>
    <div id="graph">Loading Diagram...</div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/viz.js/2.1.2/viz.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/viz.js/2.1.2/full.render.js"></script>
    <script>
        var dotLines = `digraph RivetArchitecture {
  rankdir=LR;
  node [fontname="Arial", shape=box, style=filled, fillcolor=white];
  edge [fontname="Arial", fontsize=10];
  graph [style=filled, fillcolor="#eeeeee"];

  subgraph cluster_FlightCore {
    label = "FlightCore : Autopilot";
    style = rounded;
    color = black;
    bgcolor = white;
    FlightCore [label="FlightCore", shape=component, fillcolor="#d0e0ff"];
    FlightCore__state [label="sys/state\n<string>", shape=ellipse, style=filled, fillcolor="#ddffdd"];
    FlightCore__altitude [label="nav/alt\n<float>", shape=ellipse, style=filled, fillcolor="#ddffdd"];
    FlightCore__battery [label="pwr/volts\n<float>", shape=ellipse, style=filled, fillcolor="#ddffdd"];
  }

  subgraph cluster_Perception {
    label = "Perception : LidarScanner";
    style = rounded;
    color = black;
    bgcolor = white;
    Perception [label="Perception", shape=component, fillcolor="#d0e0ff"];
    Perception__distance [label="sense/dist\n<float>", shape=ellipse, style=filled, fillcolor="#ddffdd"];
    Perception__object_detected [label="sense/obj\n<bool>", shape=ellipse, style=filled, fillcolor="#ddffdd"];
  }

  subgraph cluster_Motors {
    label = "Motors : ESCController";
    style = rounded;
    color = black;
    bgcolor = white;
    Motors [label="Motors", shape=component, fillcolor="#d0e0ff"];
    Motors__rpm [label="act/speed\n<int>", shape=ellipse, style=filled, fillcolor="#ddffdd"];
    Motors__temp [label="act/temp\n<float>", shape=ellipse, style=filled, fillcolor="#ddffdd"];
  }

  subgraph cluster_BlackBox {
    label = "BlackBox : SDCard";
    style = rounded;
    color = black;
    bgcolor = white;
    BlackBox [label="BlackBox", shape=component, fillcolor="#d0e0ff"];
    BlackBox__storage_used [label="sys/disk\n<int>", shape=ellipse, style=filled, fillcolor="#ddffdd"];
  }
    FlightCore -> FlightCore__altitude [color=blue];
  FlightCore__altitude -> Perception [color=green];
    Perception -> Perception__distance [color=blue];
    Motors -> Motors__rpm [color=blue];
    Motors -> Motors__rpm [color=blue];
    Motors -> Motors__rpm [color=blue];
  FlightCore__state -> BlackBox [color=green];
    FlightCore -> FlightCore__battery [color=blue];
    FlightCore -> FlightCore__state [color=blue];
    Motors -> BlackBox [style=dashed, label="flush"];
    Motors -> Motors [style=dashed, label="spin"];
    Motors -> Motors [style=dashed, label="spin"];
    Motors -> Motors [style=dashed, label="spin"];
    FlightCore -> Perception [style=dashed, label="scan"];
}
`;
        var viz = new Viz();
        viz.renderSVGElement(dotLines)
            .then(function(element) {
                var container = document.getElementById("graph");
                container.innerHTML = "";
                container.appendChild(element);
            })
            .catch(function(error) {
                console.error(error);
                document.getElementById("graph").innerHTML = 
                    "<h3 style='color:red'>Error rendering graph</h3><pre>" + error + "</pre>";
            });
    </script>
</body>
</html>
    